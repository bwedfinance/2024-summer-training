{
  "hash": "418e4db03f2b73b3a3e7e193b582f14f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Modeling state funding policy changes in R\"\ndate: \"July 30, 2024\"\nformat:\n  revealjs:\n    chalkboard: true\nexecute:\n  freeze: auto\n  echo: false\n---\n\n\n## Agenda\n\n-   Homework/Capstone Notes\n-   Modeling changes to a funding stream \n-   Break\n-   Modeling wholesale funding reform \n-   Partner activity\n-   Homework and next class\n\n# Modeling Potential Policy Changes to a Funding Stream in R\n\n## Over the past 8 weeks, you've learned how to use R to solve specific analysis problems\n\n-   Import, clean, and analyze large (and often messy) data sets\n-   Join multiple data sets together\n-   Create high-quality maps, scatter plots, and bar charts\n-   Model state funding policies\n\n## Today, you'll learn how to model the impact of potential policy changes\n\nWhile modeling current funding formulas is important to identify what's working and areas for improvement, it's also important to be able to model and visualize the potential impact of policy changes. This is important for several reasons:\n\n-   Allows you to assess potential financial impact at the state and district level\n-   Serves as a check to ensure that the intended student groups would be positively impacted or illustrate potential unintended consequences\n-   Can provide powerful data visualizations to illustrate the impact of the potential policy change\n\n## Before you start modeling your policy changes, make sure you clarify the problem you'd like to solve\n\n- In what _specific_ ways does current policy fall short?\n- Which policy options should be considered as alternatives?\n- How will you know if these alternative policies would be an improvement over current policy?\n- Do you have the right data to answer these questions?\n\n**Once you have clear answers to these questions, it's time to start modeling and assessing the impact of potential policy changes.**\n\n## Minnesota Example: Overview of compensatory revenue {.smaller}\n\nIn class 7, we went over the fundamentals and thought processes for building Minnesota's compensatory revenue formula, which is the state's funding stream for low-income students. Minnesota invests ~$551 million annually in compensatory revenue, which are state funds that are supposed to support the academic achievement of students who are not meeting state standards. There are three main policy issues with the current funding formula:\n\n-   Students who qualify for Reduced Price Lunch are weighted as 0.5.\n-   Schools where more than 80% of their students are in poverty do not see increases in per pupil compensatory revenue.\n-   The full base amount is not applied to the weight \n\n## Turning back to our questions: Are we ready to start modeling? {.smaller}\n\n- **In what _specific_ ways does current policy fall short?**\n    - Reduced price weight\n    - 80% cap \n    - The full per-pupil base isn't applied to the weight \n    \n- **Which policy options should be considered as alternatives?**\n    - Remove the cap\n    - Increase the reduced price weight from .5 to .75\n    - Do not subtract any fundign from the base \n    \n- **How will you know if these alternative policies would be an improvement over current policy?**\n    - More revenue going to the highest-poverty schools\n    \n- **Do you have the right data to answer these questions?**\n    - Yes!\n\n## Minnesota Example: Model current compensatory revenue funding stream\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load -------\nlibrary(tidyverse)\nlibrary(ggplot2)\n\nsource(\"mn_example/scripts/2_mn_comprev_data.R\")\n\n# Build Compensatory Revenue Formula ------\n\n# hard code in the variables \n\nreduced_weight <- 0.5\n\nfunding_cap <- 0.8\n\nweight_factor <- 0.6\n\nmn_pp_base <- 6567\n\nbase_subtractor <- 839\n\n##Calculate the compensatory revenue per school and rebuild the model\ncomprev_schools_model <- mn_comprev_final |>\n        #Step 1: Split the reduced price student count in half because they are only worth .5 in the compensatory revenue formula \n  mutate(comprev_reduced_count = reduced_lunch * reduced_weight, \n         #Step 2:Add together the .5 reduced price count to the free count to get the corrected frpl number for the compensatory revenue formula \n         comprev_frpl_reduced_total = comprev_reduced_count + free_lunch, \n         comprev_frpl_reduced_pct = comprev_frpl_reduced_total/enroll, #This is the new frpl % with .5 reduced price count\n         #Step 3: Divide by the weight factor by .8\n         comprev_weight_factor_step = comprev_frpl_reduced_pct/funding_cap, \n         ### I'm keeping this interim step so that I can track it\n         #Replace anything above 1 with 1 because of the formula \n         comprev_weight_factor = ifelse(comprev_weight_factor_step > 1, \n                                        1, comprev_weight_factor_step), \n         # determine the compensatory revenue pupil unit count \n         comprev_comp_pupil_unit = comprev_frpl_reduced_total* comprev_weight_factor* weight_factor , \n         # determine the amount of money that the school generates\n         comprev_total = comprev_comp_pupil_unit* (mn_pp_base - base_subtractor), \n         # per-pupil amount for the school that generates the funds \n         comprev_pp = comprev_total/frpl_total)\n```\n:::\n\n\n## Scatterplot of the current compensatory revenue formula illustrates some of the issues\n\n![](mn_example/figures/plot1_current_comp_rev.png){fig-align=\"center\" width=\"8in\"}\n\n## Minnesota Example: Lifting the 80% cap on per-pupil funding {.smaller}\n\nThe 80% cap on per-pupil funding has a large impact on schools that serve 80% or more low-income students. Lifting the cap, would provide 150 charter and district schools that serve the largest concentrations of students in poverty and only cost the state about \\$9.4 million annually.\n\nModeling the potential change in R is simple - we just have to comment out the line that changes the compensatory revenue weight factor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modeling Policy Changes  ------\n\n## Policy Change #1: Lift the 80% cap \n#To lift the cap, I will take the original data and not change the compensatory weight factor to 1 if it's above 1\n\n# hard code in the variables \n\nreduced_weight <- 0.5\n\nfunding_cap <- 0.8\n\nweight_factor <- 0.6\n\nmn_pp_base <- 6567\n\nbase_subtractor <- 839\n\n# Lift the 80% Cap \n\ncomprev_schools_policy_1 <- mn_comprev_final |>\n  mutate(comprev_reduced_count = reduced_lunch * reduced_weight, \n         \n         comprev_frpl_reduced_total = comprev_reduced_count + free_lunch, \n         \n         comprev_frpl_reduced_pct = comprev_frpl_reduced_total/enroll, \n         \n         comprev_weight_factor = comprev_frpl_reduced_pct/funding_cap, \n         \n         # I commented out this code because we are no longer capping the per-pupil funding \n         \n         # comprev_weight_factor = ifelse(comprev_weight_factor_step > 1, \n         #                                1, comprev_weight_factor_step), \n         \n         # determine the compensatory revenue pupil unit count \n         comprev_comp_pupil_unit_policy_1 = comprev_frpl_reduced_total * comprev_weight_factor * weight_factor, \n         \n         # determine the amount of money that the school generates\n         comprev_total_policy_1 = comprev_comp_pupil_unit_policy_1 * (mn_pp_base - base_subtractor), \n         \n         # per-pupil amount for the school that generates the funds \n         comprev_pp_policy1 = comprev_total_policy_1/frpl_total)\n```\n:::\n\n\n## The impact of lifting the 80% on per-pupil funding\n\nThe scatterplot illustrates that schools that have 80%+ low-income students are now receiving an increase in per-pupil funding.\n\n![](mn_example/figures/plot2_policy1_comp_rev.png){fig-align=\"center\" width=\"8in\"}\n\n## Minnesota Example: Increase the weight of reduced price lunch students {.smaller}\n\nIncreasing the statutory amount a reduced priced student counts from 0.5 to 0.75 would be more in line with the percentage difference between free and reduced price lunch income cutoffs for a family of four.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modeling Policy Changes  ------\n\n## Policy Change #2: Increase reduced price lunch weight from 0.5 to 0.75\n\n# hard code in the variables \n\nreduced_weight <- 0.75\n\nfunding_cap <- 0.8\n\nweight_factor <- 0.6\n\nmn_pp_base <- 6567\n\nbase_subtractor <- 839\n\n# Increase weight from 0.5 to .75\n\ncomprev_schools_policy_2 <-comprev_schools_model |>\n  # I changed the number from 0.5 to 0.75\n  mutate(comprev_reduced_count_policy2 = reduced_lunch * reduced_weight, \n         \n         comprev_frpl_reduced_total_policy2 = comprev_reduced_count_policy2 + free_lunch, \n         \n         comprev_frpl_reduced_pct_policy2 = comprev_frpl_reduced_total_policy2/enroll, \n         \n         comprev_weight_factor_step_policy2 = comprev_frpl_reduced_pct_policy2/funding_cap, \n         \n         \n         comprev_weight_factor_policy2 = ifelse(comprev_weight_factor_step_policy2 > 1, \n                                                1, comprev_weight_factor_step_policy2), \n         \n         # determine the compensatory revenue pupil unit count \n         comprev_comp_pupil_unit_policy2 = comprev_frpl_reduced_total_policy2 * comprev_weight_factor_policy2 * weight_factor, \n         \n         # determine the amount of money that the school generates\n         comprev_total_policy2 = comprev_comp_pupil_unit_policy2 * (mn_pp_base - base_subtractor), \n         \n         # per-pupil amount for the school that generates the funds \n         comprev_pp_policy2 = comprev_total_policy2/frpl_total,\n         \n         policy2_pp_increase = comprev_pp_policy2 - comprev_pp)\n```\n:::\n\n\n## Impact on increasing the reduced price weight from 0.5 to .75 {.smaller}\n\nThe scatterplot shows the increase in per-pupil funding when the weight for reduced price lunch students is increased. Not every school would benefit from the change, because they either have 0 or very few students who qualify for reduced price lunch. Schools with more students who qualify for reduced price lunch would benefit more than schools that do not.\n\nIncreasing the reduced price lunch weight would benefit more than 1,600 schools and would cost the state about $40.1 million annually.\n\n![](mn_example/figures/plot3_policy2_comp_rev.png){fig-align=\"center\" width=\"8in\"}\n\n## Minnesota Example: Not subtracting any funding from the base {.smaller}\n\nMultiplying the weighted enrollment by the full per-pupil base would benefit every charter and district school and cost the state about $67.3 million annually. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Model the policy change -----\n\n# hard code in the variables \n\nreduced_weight <- 0.5\n\nfunding_cap <- 0.8\n\nweight_factor <- 0.6\n\nmn_pp_base <- 6567\n\nbase_subtractor <- 839\n\n# Do not subtract any funding from the base \n\ncomprev_schools_policy_3 <-comprev_schools_model |>\n  mutate(comprev_reduced_count_policy3 = reduced_lunch * reduced_weight, \n         \n         comprev_frpl_reduced_total_policy3 = comprev_reduced_count_policy3 + free_lunch, \n         \n         comprev_frpl_reduced_pct_policy3 = comprev_frpl_reduced_total_policy3/enroll, \n         \n         comprev_weight_factor_step_policy3 = comprev_frpl_reduced_pct_policy3/funding_cap, \n         \n         \n         comprev_weight_factor_policy3 = ifelse(comprev_weight_factor_step_policy3 > 1, \n                                                1, comprev_weight_factor_step_policy3), \n         \n         # determine the compensatory revenue pupil unit count \n         comprev_comp_pupil_unit_policy3 = comprev_frpl_reduced_total_policy3 * comprev_weight_factor_policy3 * weight_factor, \n         \n         # determine the amount of money that the school generates\n         # I removed the base subtractor\n         comprev_total_policy3 = comprev_comp_pupil_unit_policy3 * (mn_pp_base), \n         \n         # per-pupil amount for the school that generates the funds \n         comprev_pp_policy3 = comprev_total_policy3/frpl_total,\n         \n         policy3_pp_increase = comprev_pp_policy3 - comprev_pp)\n```\n:::\n\n\n## Minnesota Example: Lifting the 80% cap and increasing the reduced weight {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Model the policy change -----\n\n# hard code in the variables \n\nreduced_weight <- 0.75\n\nfunding_cap <- 0.8\n\nweight_factor <- 0.6\n\nmn_pp_base <- 6567\n\nbase_subtractor <- 839\n\n\n# Increase the reduced weight and lift the 80% cap \n\ncomprev_schools_policy_4 <- comprev_schools_model |>\n  # I changed the number from 0.5 to 0.75\n  mutate(comprev_reduced_count_policy4 = reduced_lunch * reduced_weight, \n         \n         comprev_frpl_reduced_total_policy4 = comprev_reduced_count_policy4 + free_lunch, \n         \n         comprev_frpl_reduced_pct_policy4 = comprev_frpl_reduced_total_policy4/enroll, \n         \n         comprev_weight_factor_step_policy4 = comprev_frpl_reduced_pct_policy4/funding_cap, \n         \n         \n         # comprev_weight_factor_policy4 = ifelse(comprev_weight_factor_step_policy4 > 1, \n         #                                        1, comprev_weight_factor_step_policy4), \n         # \n         # determine the compensatory revenue pupil unit count \n         comprev_comp_pupil_unit_policy4 = comprev_frpl_reduced_total_policy4 *comprev_weight_factor_step_policy4 * weight_factor, \n         \n         # determine the amount of money that the school generates\n         # I removed the base subtractor\n         comprev_total_policy4 = comprev_comp_pupil_unit_policy4 * (mn_pp_base - base_subtractor), \n         \n         # per-pupil amount for the school that generates the funds \n         comprev_pp_policy4 = comprev_total_policy4/frpl_total,\n         \n         policy4_pp_increase = comprev_pp_policy4 - comprev_pp)\n```\n:::\n\n\n## Impact on increasing the reduced price weight from 0.5 to .75 and lifting the 80% cap{.smaller}\n\nThe scatterplot shows the increase in per-pupil funding when the weight for reduced price lunch students is increased and the 80% cap is lifted. Not every school would benefit from the change, because they either have 0 or very few students who qualify for reduced price lunch, or they do not have more than 80% FRPL. Schools with more students who qualify for reduced price lunch would benefit more than schools that do not, as would schools schools with more than 80% FRPL. These two policy changes would cost the state about $52 million annually. \n\n![](mn_example/figures/plot3_policy4_comp_rev.png){fig-align=\"center\" width=\"8in\"}\n\n# Modeling Wholesale Reform in R\n\n## Delaware Example: Moving from Resource to Student-Based Funding Formula \n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Hard code the variables --------\n  \n  base <- 8000 # per-pupil base funding \n  \n  ed_weight <- .5 # economically disadvantaged student weight \n  \n  sped_no_complex_intense_weight <- 0.5 # special education weight for students who are not intense or complex \n  sped_complex_weight <- 1.4 # special education weight for complex students \n  sped_intense_weight <- 2.1 # special education weight for intense, which is the state's high level of support\n\n  \n  el_weight <- .3 # English learner weight \n  \n  cte_weight <- .2 # weight for students enrolled in CTE courses \n  \n  \n  # Model the student-based funding formula  ------\n  \n delaware_wsf_model <- delaware_modeling_data |>\n    # Do the WSF modeling \n    # Base funding \n    mutate(wsf_base_funding = total_enroll * base,\n           \n           # FRPL Funding \n           wsf_frpl_funding = base * frpl_enroll * ed_weight,\n           \n           # EL Funding \n           wsf_el_funding = base * el_enroll * el_weight,\n           \n           # SPED Funding\n           wsf_sped_no_complex_intense_funding = base * sped_enroll *  sped_no_complex_intense_weight,\n           wsf_sped_complex_funding = base * complex_sped_enroll *  sped_complex_weight,\n           wsf_sped_intense_funding = base * intense_sped_enroll *  sped_intense_weight,\n           wsf_sped_total_funding = wsf_sped_no_complex_intense_funding + wsf_sped_complex_funding + wsf_sped_intense_funding, \n           \n           # CTE Funding \n           wsf_cte_funding = base * voc_enroll * cte_weight,\n           \n           # Total WSF funding\n           wsf_total_funding = wsf_base_funding + wsf_el_funding + wsf_sped_total_funding \n           + wsf_frpl_funding + wsf_cte_funding,\n           # Calculate the per-pupil funding \n           wsf_pp_funding = wsf_total_funding / total_enroll) |>\n    # Calculate the per-pupil differences \n    mutate(wsf_pp_diff = wsf_pp_funding - state_pp_revenue,\n           wsf_total_diff = wsf_total_funding - state_revenue)\n```\n:::\n\n\n\n## Delaware Example: Moving from Resource to Student-Based Funding Formula \n\nIn this WSF Model, 13 districts would receive more total and per-pupil state funding, which would be an increase of $112 million. For the districts that would lose state funding, it would cost the state $36.5 million to hold the districts harmless. \n\n![](de_example/figures/Screenshot 2024-07-24 at 2.13.27 PM.png){fig-align=\"center\" width=\"8in\"}\n\n# Small Group Activity \n\n\nBuild Minnesota's English Learner funding formula in R and then model the impact of 2 potential policy changes. \n\n## Homework\n\nTKTK \n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}